-- Create the deduplicated_list table with the common fields from titles and ratings

CREATE TABLE deduplicated_list AS
SELECT 
    titles.id,
    titles.title,
    titles.type,
    titles.description,
    titles.release_year,
    titles.age_certification,
    titles.runtime,
    titles.imdb_id,
    titles.imdb_score, 
    titles.imdb_votes ;

FROM titles
JOIN ratings ON titles.id = ratings.id;

GROUP BY
    titles.id,
    titles.title,
    titles.type,
    titles.description,
    titles.release_year,
    titles.age_certification,
    titles.runtime,
    titles.imdb_id,
    titles.imdb_score, 
    titles.imdb_votes ;

-- Verify the deduplicated list
SELECT * FROM deduplicated_list
ORDER BY title ASC
LIMIT 10;

--Checking longest and shortest runtime
/*SELECT runtime
FROM deduplicated_list
ORDER BY runtime ASC --or DESC
LIMIT 100;*/